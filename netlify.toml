[build]
  publish = "_site"
  functions = "netlify/functions"

[build.environment]
  NODE_OPTIONS = "--max-old-space-size=8192"

[functions]
  node_bundler = "esbuild"

# Sitemap redirects
[[redirects]]
  from = "/sitemap.xml"
  to = "/.netlify/functions/sitemap"
  status = 200

[[redirects]]
  from = "/sitemap-states.xml"
  to = "/.netlify/functions/sitemap"
  status = 200

[[redirects]]
  from = "/sitemap-cities.xml"
  to = "/.netlify/functions/sitemap"
  status = 200

[[redirects]]
  from = "/sitemap-shops-:num.xml"
  to = "/.netlify/functions/sitemap"
  status = 200

# Location page redirects
[[redirects]]
  from = "/locations/:state/:city/:slug/products/"
  to = "/.netlify/functions/shop-products"
  status = 200

[[redirects]]
  from = "/locations/:state/:city/:slug/products"
  to = "/.netlify/functions/shop-products"
  status = 200

[[redirects]]
  from = "/locations/:state/:city/:slug/*"
  to = "/.netlify/functions/location-page"
  status = 200

[[redirects]]
  from = "/locations/:state/:city/"
  to = "/.netlify/functions/city-page"
  status = 200

[[redirects]]
  from = "/locations/:state/"
  to = "/.netlify/functions/state-page"
  status = 200

[[redirects]]
  from = "/locations/near-me/*"
  to = "/.netlify/functions/near-me"
  status = 200

[[redirects]]
  from = "/locations/"
  to = "/.netlify/functions/locations-index"
  status = 200

[[redirects]]
  from = "/locations/search/*"
  to = "/.netlify/functions/locations-search"
  status = 200
[[redirects]]
  from = "/companies/:slug/"
  to = "/.netlify/functions/company-page"
  status = 200

[[redirects]]
  from = "/companies/:slug"
  to = "/.netlify/functions/company-page"
  status = 200
[[redirects]]
  from = "/sitemap-shops-1.xml"
  to = "/.netlify/functions/sitemap"
  status = 200

[[redirects]]
  from = "/sitemap-shops-2.xml"
  to = "/.netlify/functions/sitemap"
  status = 200

[[redirects]]
  from = "/sitemap-shops-3.xml"
  to = "/.netlify/functions/sitemap"
  status = 200

[[redirects]]
  from = "/sitemap-shops-4.xml"
  to = "/.netlify/functions/sitemap"
  status = 200

[[redirects]]
  from = "/sitemap-shops-5.xml"
  to = "/.netlify/functions/sitemap"
  status = 200
