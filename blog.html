<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog | joe Coffee</title>
  <meta name="description" content="Stories from the joe community. Tips for coffee lovers, shop spotlights, and the latest from indie coffee culture.">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Blog | joe Coffee">
  <meta property="og:description" content="Stories from the joe community. Tips, spotlights, and indie coffee culture.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://joe.coffee/blog">
  <meta property="og:site_name" content="joe Coffee">
  
  <link rel="canonical" href="https://joe.coffee/blog">
  <link rel="icon" type="image/png" href="https://4591743.fs1.hubspotusercontent-na1.net/hubfs/4591743/Black.png">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Fraunces:wght@500;600;700&display=swap" rel="stylesheet">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['DM Sans', 'sans-serif'],
            display: ['Fraunces', 'serif'],
          },
          colors: {
            joe: { red: '#E53935', dark: '#1a1a1a', cream: '#FDF8F3' }
          }
        }
      }
    }
  </script>
  
  <!-- JSON-LD Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Blog",
    "name": "joe Coffee Blog",
    "description": "Stories from the indie coffee community.",
    "url": "https://joe.coffee/blog",
    "publisher": {
      "@type": "Organization",
      "name": "joe Coffee",
      "logo": { "@type": "ImageObject", "url": "https://joe.coffee/images/logo.png" }
    }
  }
  </script>
  
  <style>
    body { font-family: 'DM Sans', sans-serif; }
    .font-display { font-family: 'Fraunces', serif; }
    .nav-blur { backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
    .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
    .blog-card { transition: all 0.3s ease; }
    .blog-card:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.1); }
    .category-btn.active { background: #1a1a1a; color: white; }
    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body class="min-h-screen bg-white text-gray-900">
  
  <!-- Navigation -->
  <nav class="fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-100 nav-blur" style="background-color: rgba(255,255,255,0.95);">
    <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
      <a href="/" class="flex items-center">
        <img src="https://4591743.fs1.hubspotusercontent-na1.net/hubfs/4591743/Black.png" alt="joe" class="h-8">
      </a>
      <div class="hidden md:flex items-center gap-8 text-sm text-gray-600">
        <a href="/cities" class="hover:text-black transition-colors">Find Shops</a>
        <a href="/blog" class="text-black font-medium">Blog</a>
        <a href="/testimonials" class="hover:text-black transition-colors">Success Stories</a>
        <a href="https://joe.coffee" class="hover:text-black transition-colors">For Coffee Shops</a>
      </div>
      <a href="https://apps.apple.com/us/app/joe-coffee-order-ahead/id1437558382" class="bg-joe-dark text-white px-5 py-2.5 rounded-full text-sm font-semibold hover:bg-black transition-colors">
        Get the App
      </a>
    </div>
  </nav>

  <!-- Hero -->
  <section class="pt-28 pb-8 bg-joe-cream">
    <div class="max-w-7xl mx-auto px-6">
      <h1 class="font-display text-4xl md:text-5xl font-bold text-joe-dark mb-4">The joe Blog</h1>
      <p class="text-lg text-gray-600 max-w-2xl">
        Stories from the indie coffee community. Shop spotlights, brewing tips, and what's new at joe.
      </p>
    </div>
  </section>

  <!-- Category Filter -->
  <section class="border-b border-gray-100 sticky top-[73px] bg-white z-40">
    <div class="max-w-7xl mx-auto px-6">
      <div class="flex gap-2 py-4 overflow-x-auto hide-scrollbar">
        <button class="category-btn active px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all" data-category="all">All Posts</button>
        <button class="category-btn px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium whitespace-nowrap hover:bg-gray-200 transition-all" data-category="community">Shop Spotlights</button>
        <button class="category-btn px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium whitespace-nowrap hover:bg-gray-200 transition-all" data-category="industry-trends">Industry Trends</button>
        <button class="category-btn px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium whitespace-nowrap hover:bg-gray-200 transition-all" data-category="build-in-public">Build In Public</button>
        <button class="category-btn px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium whitespace-nowrap hover:bg-gray-200 transition-all" data-category="loyalty-marketing">Loyalty & Marketing</button>
        <button class="category-btn px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium whitespace-nowrap hover:bg-gray-200 transition-all" data-category="mobile-ordering">Mobile Ordering</button>
        <button class="category-btn px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium whitespace-nowrap hover:bg-gray-200 transition-all" data-category="barista">Barista</button>
      </div>
    </div>
  </section>

  <!-- Blog Grid -->
  <section class="py-12 bg-white">
    <div class="max-w-7xl mx-auto px-6">
      
      <!-- Loading State -->
      <div id="loading-state" class="text-center py-16">
        <div class="w-8 h-8 border-4 border-joe-red border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
        <p class="text-gray-500">Loading posts...</p>
      </div>
      
      <!-- Posts Grid -->
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8" id="blog-grid"></div>
      
      <!-- Empty State -->
      <div id="empty-state" class="hidden text-center py-16">
        <p class="text-gray-500">No posts found in this category</p>
      </div>

      <!-- Load More -->
      <div class="text-center mt-12" id="load-more-container">
        <button id="load-more-btn" class="px-8 py-3 bg-gray-100 text-gray-700 rounded-full font-medium hover:bg-gray-200 transition-colors hidden">
          Load More Posts
        </button>
      </div>
    </div>
  </section>

  <!-- Newsletter CTA -->
  <section class="py-16 bg-joe-dark text-white">
    <div class="max-w-2xl mx-auto px-6 text-center">
      <h2 class="font-display text-3xl font-bold mb-4">Get the latest from joe</h2>
      <p class="text-gray-400 mb-8">Weekly stories, tips, and updates from the indie coffee community.</p>
      <form class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto" id="newsletter-form">
        <input 
          type="email" 
          name="email"
          placeholder="Enter your email" 
          class="flex-1 px-5 py-3 rounded-full bg-white text-black placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-joe-red"
          required
        >
        <button type="submit" class="px-8 py-3 bg-joe-red text-white rounded-full font-semibold hover:bg-red-600 transition-colors">
          Subscribe
        </button>
      </form>
      <p class="text-gray-500 text-sm mt-4">No spam. Unsubscribe anytime.</p>
    </div>
  </section>

  <!-- Footer -->
  <footer class="py-12 bg-joe-cream border-t border-gray-200">
    <div class="max-w-7xl mx-auto px-6">
      <div class="flex flex-col md:flex-row justify-between items-center gap-6">
        <div class="flex items-center gap-6">
          <img src="https://4591743.fs1.hubspotusercontent-na1.net/hubfs/4591743/Black.png" alt="joe" class="h-6">
          <span class="text-gray-400 text-sm">Â© 2025 joe Coffee</span>
        </div>
        <div class="flex gap-6 text-sm text-gray-500">
          <a href="/cities" class="hover:text-black transition-colors">Find Shops</a>
          <a href="/blog" class="hover:text-black transition-colors">Blog</a>
          <a href="/testimonials" class="hover:text-black transition-colors">Success Stories</a>
          <a href="https://joe.coffee" class="hover:text-black transition-colors">For Coffee Shops</a>
          <a href="https://joe.coffee/terms-of-service-privacy-policy/" class="hover:text-black transition-colors">Privacy</a>
        </div>
      </div>
    </div>
  </footer>

  <script>
    const BlogPage = {
      posts: [],
      filteredPosts: [],
      currentCategory: 'all',
      page: 1,
      perPage: 9,
      
      repoOwner: 'brendencoffey',
      repoName: 'joe-marketing-site',
      
      categoryColors: {
        'industry-trends': { bg: 'bg-amber-50', text: 'text-amber-700' },
        'build-in-public': { bg: 'bg-purple-50', text: 'text-purple-700' },
        'loyalty-marketing': { bg: 'bg-green-50', text: 'text-green-700' },
        'coffee-shop-marketing': { bg: 'bg-green-50', text: 'text-green-700' },
        'mobile-ordering': { bg: 'bg-blue-50', text: 'text-blue-700' },
        'coffee-shop-owner': { bg: 'bg-rose-50', text: 'text-rose-700' },
        'barista': { bg: 'bg-teal-50', text: 'text-teal-700' },
        'community': { bg: 'bg-indigo-50', text: 'text-indigo-700' },
        'product-updates': { bg: 'bg-cyan-50', text: 'text-cyan-700' }
      },
      
      async init() {
        this.bindEvents();
        await this.loadPosts();
        this.filterPosts();
        this.render();
      },
      
      async loadPosts() {
        try {
          const response = await fetch(`https://api.github.com/repos/${this.repoOwner}/${this.repoName}/contents/blog/posts`);
          if (!response.ok) throw new Error('Failed to fetch');
          
          const files = await response.json();
          
          for (const file of files) {
            if (!file.name.endsWith('.md') || file.name === '.gitkeep') continue;
            
            try {
              const contentResponse = await fetch(file.download_url);
              const content = await contentResponse.text();
              const parsed = this.parseFrontMatter(content);
              
              // Only include published posts
              if (parsed.data.status === 'published' || !parsed.data.status) {
                this.posts.push({
                  ...parsed.data,
                  slug: file.name.replace('.md', ''),
                  body: parsed.content
                });
              }
            } catch (e) {
              console.error(`Error parsing ${file.name}:`, e);
            }
          }
          
          // Sort by date
          this.posts.sort((a, b) => new Date(b.date) - new Date(a.date));
          
        } catch (error) {
          console.error('Error loading posts:', error);
        }
        
        document.getElementById('loading-state').classList.add('hidden');
      },
      
      parseFrontMatter(content) {
        const match = content.match(/^---\n([\s\S]*?)\n---\n([\s\S]*)$/);
        if (!match) return { data: {}, content };
        
        const frontMatter = match[1];
        const body = match[2];
        const data = {};
        
        let currentKey = null;
        let inList = false;
        let listItems = [];
        
        frontMatter.split('\n').forEach(line => {
          const keyMatch = line.match(/^(\w+):\s*(.*)$/);
          if (keyMatch) {
            if (inList && currentKey) {
              data[currentKey] = listItems;
              listItems = [];
              inList = false;
            }
            
            currentKey = keyMatch[1];
            const value = keyMatch[2].trim();
            
            if (value === '') {
              inList = true;
            } else if (value.startsWith('"') && value.endsWith('"')) {
              data[currentKey] = value.slice(1, -1);
            } else if (value === 'true') {
              data[currentKey] = true;
            } else if (value === 'false') {
              data[currentKey] = false;
            } else {
              data[currentKey] = value;
            }
          } else if (line.match(/^\s+-\s+(.*)$/)) {
            inList = true;
            const item = line.match(/^\s+-\s+(.*)$/)[1];
            listItems.push(item.replace(/^["']|["']$/g, ''));
          }
        });
        
        if (inList && currentKey) {
          data[currentKey] = listItems;
        }
        
        return { data, content: body };
      },
      
      filterPosts() {
        if (this.currentCategory === 'all') {
          this.filteredPosts = [...this.posts];
        } else {
          this.filteredPosts = this.posts.filter(post => post.category === this.currentCategory);
        }
        this.page = 1;
      },
      
      render() {
        const grid = document.getElementById('blog-grid');
        const emptyState = document.getElementById('empty-state');
        const loadMoreBtn = document.getElementById('load-more-btn');
        
        const visiblePosts = this.filteredPosts.slice(0, this.page * this.perPage);
        
        if (visiblePosts.length === 0) {
          grid.innerHTML = '';
          emptyState.classList.remove('hidden');
          loadMoreBtn.classList.add('hidden');
          return;
        }
        
        emptyState.classList.add('hidden');
        grid.innerHTML = '';
        
        visiblePosts.forEach(post => {
          const colors = this.categoryColors[post.category] || { bg: 'bg-gray-100', text: 'text-gray-700' };
          
          const card = document.createElement('a');
          card.href = `/blog/posts/${post.slug}/`;
          card.className = 'blog-card block bg-white rounded-2xl overflow-hidden border border-gray-100';
          
          card.innerHTML = `
            <div class="aspect-video bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden">
              ${post.featured_image ? `<img src="${post.featured_image}" alt="${post.title}" class="w-full h-full object-cover">` : ''}
            </div>
            <div class="p-5">
              <div class="flex items-center gap-3 mb-3">
                <span class="${colors.bg} ${colors.text} px-2.5 py-1 rounded-full text-xs font-medium">${this.formatCategory(post.category)}</span>
                <span class="text-gray-400 text-sm">${this.formatDate(post.date)}</span>
              </div>
              <h3 class="text-lg font-bold text-gray-900 mb-2 line-clamp-2">${post.title}</h3>
              <p class="text-gray-600 text-sm line-clamp-2">${post.excerpt || ''}</p>
              ${post.tags?.length ? `
                <div class="flex flex-wrap gap-2 mt-3">
                  ${post.tags.slice(0, 3).map(tag => `<span class="text-xs text-gray-400">#${tag}</span>`).join('')}
                </div>
              ` : ''}
            </div>
          `;
          
          grid.appendChild(card);
        });
        
        // Show/hide load more
        if (visiblePosts.length < this.filteredPosts.length) {
          loadMoreBtn.classList.remove('hidden');
        } else {
          loadMoreBtn.classList.add('hidden');
        }
      },
      
      formatCategory(category) {
        if (!category) return 'General';
        return category.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
      },
      
      formatDate(dateStr) {
        if (!dateStr) return '';
        const date = new Date(dateStr);
        return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
      },
      
      bindEvents() {
        // Category filters
        document.querySelectorAll('.category-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            // Update active state
            document.querySelectorAll('.category-btn').forEach(b => {
              b.classList.remove('active', 'bg-joe-dark', 'text-white');
              b.classList.add('bg-gray-100', 'text-gray-700');
            });
            btn.classList.add('active', 'bg-joe-dark', 'text-white');
            btn.classList.remove('bg-gray-100', 'text-gray-700');
            
            // Filter posts
            this.currentCategory = btn.dataset.category;
            this.filterPosts();
            this.render();
          });
        });
        
        // Load more
        document.getElementById('load-more-btn').addEventListener('click', () => {
          this.page++;
          this.render();
        });
        
        // Newsletter form
        document.getElementById('newsletter-form').addEventListener('submit', (e) => {
          e.preventDefault();
          alert('Thanks for subscribing!');
          e.target.reset();
        });
      }
    };
    
    document.addEventListener('DOMContentLoaded', () => BlogPage.init());
  </script>

</body>
</html>
